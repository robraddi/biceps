

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>&lt;no title&gt; &mdash; BICePs 2.0-beta documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> BICePs
          

          
          </a>

          
            
            
              <div class="version">
                2.0-beta
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../theory.html">Theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../workflow.html">Workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api.html">API Reference</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">BICePs</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
      <li>&lt;no title&gt;</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/tutorials/BICePs_example/BICePs_example.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 250px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 5ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 250px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 250px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="admonition note">
This page was generated from <a class="reference external" href="https://github.com/spatialaudio/nbsphinx/blob/2.0-beta/doc/tutorials/BICePs_example/BICePs_example.ipynb">doc/tutorials/BICePs_example/BICePs_example.ipynb</a>.
Interactive online version:
<span class="raw-html"><a href="https://mybinder.org/v2/gh/spatialaudio/nbsphinx/2.0-beta?filepath=doc/tutorials/BICePs_example/BICePs_example.ipynb"><img alt="Binder badge" src="https://mybinder.org/badge.svg" style="vertical-align:text-bottom"></a></span></div>
<p>In this tutorial, we are going to show how to set up a “master” script to set up BICePs samplings. You are welcome to take this as a template for you and make necessary modification to get it work for you. All input files used in this tutorial are prepared from <a class="reference external" href="https://github.com/vvoelz/biceps/blob/master/BICePs_2.0/tutorials/Preparation/Preparation.ipynb">this tutorial</a>.</p>
<p>Yunhui Ge –02/2019</p>
<p>First, we need to import source code for BICePs classes. More information of these classes can be found <a class="reference external" href="https://github.com/vvoelz/biceps/blob/master/BICePs_2.0/markdown/workflow.md">here</a>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># import source code</span>
<span class="kn">import</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">glob</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;biceps&#39;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">Preparation</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">PosteriorSampler</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">Analysis</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">Restraint</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">init_res</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
</div>
<p>Now we need to specify input files and output files folder.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">############ Initialization #############</span>
<span class="c1"># Specify necessary argument values</span>

<span class="c1"># REQUIRED: specify number of states</span>
<span class="n">states</span><span class="o">=</span><span class="mi">100</span>

<span class="c1"># REQUIRED: specify directory of input data (BICePs readable format)</span>
<span class="n">dataFiles</span> <span class="o">=</span> <span class="s1">&#39;noe_J&#39;</span>

<span class="c1"># REQUIRED: sort data and figure out what experimental restraints are included for each state</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">sort_data</span><span class="p">(</span><span class="n">dataFiles</span><span class="p">)</span>

<span class="c1"># REQUIRED: energy file name of each state (computational prior distribution)</span>

<span class="n">energies_filename</span> <span class="o">=</span> <span class="s1">&#39;energy.dat&#39;</span>
<span class="n">energies</span> <span class="o">=</span> <span class="n">loadtxt</span><span class="p">(</span><span class="n">energies_filename</span><span class="p">)</span>
<span class="n">energies</span> <span class="o">-=</span> <span class="n">energies</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>  <span class="c1"># set ground state to zero, just in case</span>

<span class="c1"># REQUIRED: specify outcome directory of BICePs sampling</span>
<span class="n">outdir</span> <span class="o">=</span> <span class="s1">&#39;results_ref_normal&#39;</span>
<span class="c1"># Make a new directory if we have to</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">outdir</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">outdir</span><span class="p">)</span>

</pre></div>
</div>
</div>
<p>Next, we need to specify number of steps for BICePs sampling. We recommend to run at least 1M steps for converged Monte Carlo samplings. In BICePs, we also prepare functions of checking convergence of Monte Carlo. More information can be found [here].</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># REQUIRED: number of MCMC steps for each lambda</span>
<span class="n">nsteps</span> <span class="o">=</span> <span class="mi">1000000</span>
</pre></div>
</div>
</div>
<p>We need to specify what lambda values we want to use in BICePs samplings. Briefly, lambda values are similar to the parameters used in free energy perturbation (FEP) and has effect on the BICePs score. The lambda values represent how much prior information from computational modeling is included in BICePs sampling (1.0 means all, 0.0 means none). As we explained in <a class="reference external" href="https://pubs.acs.org/doi/10.1021/acs.jpcb.7b11871">this work</a>, one can consider BICePs score as the relative free energy change
between different models. More lambda values will increase the samplings for <a class="reference external" href="http://www.alchemistry.org/wiki/Multistate_Bennett_Acceptance_Ratio">multistate Bennett acceptance ratio (MBAR)</a> predictions in free energy change and populations. However more lambda values also will slow down the whole process of BICePs (as more samplings need to run), so balancing the accuracy and efficiency is important. To successfully finish a BICePs sampling, lambda values of 0.0 and 1.0 are necessary. Based
on our experience, the lambda values of 0.0,0.5,1.0 are good enough for BICePs sampling.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># REQUIRED: specify how many lambdas to sample (more lambdas will provide higher accuracy but slower the whole process, lambda=0.0 and 1.0 are necessary)</span>
<span class="n">lambda_values</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">1.0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<p>Print what experimental observables are included in BICePs sampling. This is optional and provides a chance for double check before running BICePs sampling.</p>
<p>In this tutorial, we used both J couplings and NOE (pairwise distances) in BICePs sampling.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># OPTIONAL but RECOMMENDED: print experimental restraints included (a chance for double check)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">list_res</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="k">print</span> <span class="n">res</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;J&#39;, &#39;noe&#39;]
</pre></div></div>
</div>
<p>Anoter key parameter for BICePs set-up is the type of reference potential for each experimental observables. More information of reference potential can be found <a class="reference external" href="https://github.com/vvoelz/biceps/blob/master/BICePs_2.0/markdown/Theory.ipynb">here</a>.</p>
<p>Three reference potentials are supported in BICePs: uniform (‘uniform’), exponential (‘exp’), Gaussian (‘gau’).</p>
<p>As we found in previous research, exponential reference potential is useful in most cases. Some higher level task may require more in reference potential selection (e.g <a class="reference external" href="https://pubs.acs.org/doi/10.1021/acs.jpcb.7b11871">force field parametrization</a>).</p>
<p>(Noet: It will be helpful to print out what is the order of experimental observables included in BICePs sampling as shown above.)</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># REQUIRED: specify reference potential to use for each experimental observable</span>
<span class="c1"># will be in the same order as the printed observables from (print res)</span>
<span class="n">ref</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;uniform&#39;</span><span class="p">,</span><span class="s1">&#39;exp&#39;</span><span class="p">]</span>

</pre></div>
</div>
</div>
<p>If you want, you can specify nuisance parameters (uncertainty in experiments) range but it’s not required. Our default parameters range is broad enough. “gamma” is a scaling factor converting distances to NOE intensity in experiments. It is only used when NOE restraint is ued in BICePs sampling.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># OPTIONAL: specify nuisance parameters for each experimnetal observable</span>
<span class="c1"># will be in the same order as the printed observables from (print res)</span>
<span class="c1"># only specify if you want to narrow down the default range</span>
<span class="n">uncern</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">20.0</span><span class="p">,</span><span class="mf">1.02</span><span class="p">],[</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">5.0</span><span class="p">,</span><span class="mf">1.02</span><span class="p">]]</span>
<span class="n">gamma</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">5.0</span><span class="p">,</span><span class="mf">1.01</span><span class="p">]</span>
</pre></div>
</div>
</div>
<p>Now we need to set up BICePs samplings and feed arguments using variables we defined above. In most cases, you don’t need to modify this part as long as you defined all these parameters shown above.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">######################</span>
<span class="c1"># Main:</span>
<span class="c1">######################</span>

<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">lambda_values</span><span class="p">:</span>
    <span class="k">print</span> <span class="s1">&#39;lambda&#39;</span><span class="p">,</span> <span class="n">j</span>
    <span class="n">verbose</span> <span class="o">=</span> <span class="bp">False</span> <span class="c1">#False</span>
    <span class="n">lam</span> <span class="o">=</span> <span class="n">j</span>
    <span class="c1"># We will instantiate a number of Restraint() objects to construct the ensemble</span>
    <span class="c1"># experimental data and pre-computed model data are compiled for each state</span>
    <span class="n">ensemble</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">energies</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>   <span class="c1"># number of states</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="k">print</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">#### STRUCTURE </span><span class="si">%d</span><span class="s1"> ####&#39;</span><span class="o">%</span><span class="k">i</span>
        <span class="n">ensemble</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>   <span class="c1"># number of experimental observables</span>
            <span class="n">File</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">k</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="k">print</span> <span class="n">File</span>
            <span class="n">R</span><span class="o">=</span><span class="n">init_res</span><span class="p">(</span><span class="s1">&#39;top/</span><span class="si">%d</span><span class="s1">.fixed.pdb&#39;</span><span class="o">%</span><span class="k">i</span>,lam,energies[i],ref[k],File,uncern[k],gamma)
            <span class="n">ensemble</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
        <span class="c1">#print ensemble</span>

    <span class="c1">##########################################</span>
    <span class="c1"># Next, let&#39;s do posterior MCMC sampling</span>
    <span class="c1">########## Posterior Sampling ############</span>

    <span class="n">sampler</span> <span class="o">=</span> <span class="n">PosteriorSampler</span><span class="p">(</span><span class="n">ensemble</span><span class="p">)</span>
    <span class="n">sampler</span><span class="o">.</span><span class="n">compile_nuisance_parameters</span><span class="p">()</span>

    <span class="n">sampler</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">nsteps</span><span class="p">)</span>  <span class="c1"># number of steps</span>

    <span class="k">print</span> <span class="s1">&#39;Processing trajectory...&#39;</span><span class="p">,</span>

    <span class="n">sampler</span><span class="o">.</span><span class="n">traj</span><span class="o">.</span><span class="n">process</span><span class="p">()</span>  <span class="c1"># compute averages, etc.</span>
    <span class="k">print</span> <span class="s1">&#39;...Done.&#39;</span>
    <span class="k">print</span> <span class="s1">&#39;Writing results...&#39;</span><span class="p">,</span>
    <span class="n">sampler</span><span class="o">.</span><span class="n">traj</span><span class="o">.</span><span class="n">write_results</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">outdir</span><span class="p">,</span><span class="s1">&#39;traj_lambda</span><span class="si">%2.2f</span><span class="s1">.npz&#39;</span><span class="o">%</span><span class="k">lam</span>))
    <span class="k">print</span> <span class="s1">&#39;...Done.&#39;</span>
    <span class="n">sampler</span><span class="o">.</span><span class="n">traj</span><span class="o">.</span><span class="n">read_results</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">outdir</span><span class="p">,</span><span class="s1">&#39;traj_lambda</span><span class="si">%2.2f</span><span class="s1">.npz&#39;</span><span class="o">%</span><span class="k">lam</span>))
    <span class="k">print</span> <span class="s1">&#39;Pickling the sampler object ...&#39;</span><span class="p">,</span>
    <span class="n">outfilename</span> <span class="o">=</span> <span class="s1">&#39;sampler_lambda</span><span class="si">%2.2f</span><span class="s1">.pkl&#39;</span><span class="o">%</span><span class="k">lam</span>
    <span class="k">print</span> <span class="n">outfilename</span><span class="p">,</span>
    <span class="n">fout</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">outdir</span><span class="p">,</span> <span class="n">outfilename</span><span class="p">),</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span>
    <span class="c1"># Pickle dictionary using protocol 0.</span>
    <span class="n">cPickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">sampler</span><span class="p">,</span> <span class="n">fout</span><span class="p">)</span>
    <span class="n">fout</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">print</span> <span class="s1">&#39;...Done.&#39;</span>


</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
lambda 0.0

Accepted 78.9713 %


Accepted [ 24.5301  24.2915  23.8452   6.3045] %

Processing trajectory... ...Done.
Writing results... ...Done.
Pickling the sampler object ... sampler_lambda0.00.pkl ...Done.
lambda 0.5

Accepted 75.1632 %


Accepted [ 24.5772  24.337   23.8817   2.3673] %

Processing trajectory... ...Done.
Writing results... ...Done.
Pickling the sampler object ... sampler_lambda0.50.pkl ...Done.
lambda 1.0

Accepted 73.8704 %


Accepted [ 24.4841  24.3542  23.8694   1.1627] %

Processing trajectory... ...Done.
Writing results... ...Done.
Pickling the sampler object ... sampler_lambda1.00.pkl ...Done.
</pre></div></div>
</div>
<p>Now you can check your pre-defined output folder and see if the output files from BICePs sampling are there. In this case, we defined <code class="docutils literal notranslate"><span class="pre">outdir</span></code> as ‘results_ref_normal’.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ls</span> <span class="n">results_ref_normal</span><span class="o">/*</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
results_ref_normal/sampler_lambda0.00.pkl
results_ref_normal/sampler_lambda0.50.pkl
results_ref_normal/sampler_lambda1.00.pkl
results_ref_normal/traj_lambda0.00.npz
results_ref_normal/traj_lambda0.50.npz
results_ref_normal/traj_lambda1.00.npz
</pre></div></div>
</div>
<p>Then, we need to run functions in <code class="docutils literal notranslate"><span class="pre">Analysis</span></code> to get predicted populations of each conformational states and BICePs score. A figure of posterior distribution of populations and nuisance parameters will be plotted as well.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#########################################</span>
<span class="c1"># Let&#39;s do analysis using MBAR algorithm and plot figures</span>
<span class="c1">############ MBAR and Figures ###########</span>
<span class="c1"># Specify necessary argument values</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">Analysis</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="n">dataFiles</span><span class="p">,</span><span class="n">outdir</span><span class="p">)</span>
<span class="n">A</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>

</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Loading results_ref_normal/traj_lambda0.00.npz ...
Loading results_ref_normal/traj_lambda0.50.npz ...
Loading results_ref_normal/traj_lambda1.00.npz ...
Loading results_ref_normal/sampler_lambda0.00.pkl ...
Loading results_ref_normal/sampler_lambda0.50.pkl ...
Loading results_ref_normal/sampler_lambda1.00.pkl ...
lam = [0.0, 0.5, 1.0]
nstates 100
Writing BS.dat...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/Users/yunhuige/anaconda/lib/python2.7/site-packages/pymbar-3.0.3-py2.7-macosx-10.6-x86_64.egg/pymbar/mbar.py:919: RuntimeWarning: invalid value encountered in sqrt
  sigma = np.sqrt(covA_ij[0:K,0:K].diagonal())
/Users/yunhuige/anaconda/lib/python2.7/site-packages/matplotlib/scale.py:101: RuntimeWarning: invalid value encountered in less_equal
  a[a &lt;= 0.0] = 1e-300
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

...Done.
Writing populations.dat...
...Done.
</pre></div></div>
</div>
<p>The output files include: population information (“populations.dat”), figure of sampled parameters distribution (“BICePs.pdf”), BICePs score information (“BS.dat”).</p>
<p>First, let’s take a look at the populations file.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fin</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;populations.dat&#39;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">text</span> <span class="o">=</span> <span class="n">fin</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="n">fin</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="k">print</span> <span class="n">text</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1.848100802180208113e-02 1.894884993601575474e-03 2.410698459454074793e-05 1.280402543365765722e-03 1.329988784903084144e-04 1.696905651117369616e-06
4.761675616906435593e-03 6.280459740108934596e-04 1.027840908274235687e-05 6.462804530015955982e-04 8.551182227710229903e-05 1.400704430581652832e-06
7.172209802804641043e-03 6.660350849429397257e-03 7.674393477665741869e-04 5.927516519678294182e-04 5.492710384965966914e-04 6.371095205278202707e-05
1.009932844303840227e-03 2.804069185777802176e-04 9.660237118902514908e-06 2.799663067303218966e-04 7.777082748460685947e-05 2.680166694591291964e-06
1.905086325399985014e-04 9.433407857750708558e-06 5.795960333898619865e-08 1.346949549305315760e-04 6.670650712372997174e-06 4.098629525312328793e-08
1.399662387020939036e-03 3.376028756552074128e-07 1.010391770250862464e-11 3.737592638299200797e-04 9.025559100580362788e-08 0.000000000000000000e+00
7.411622035859766200e-03 5.653324273974913439e-03 5.350536901649327604e-04 6.342537688941091763e-04 4.834444170247695089e-04 4.602142310936990630e-05
1.190289672794575537e-02 6.921098278680481997e-04 4.993444185030782023e-06 1.053040080890456105e-03 6.178236563906610191e-05 4.463353115095281656e-07
2.430139356192073663e-03 5.541796766947992836e-04 1.568096711479505245e-05 4.431294662185153508e-04 1.011881268980720276e-04 2.865175024483157056e-06
5.584387201954754687e-03 1.560738567341068972e-05 5.412372772184426140e-09 7.437290909071011223e-04 2.088103042813913735e-06 7.081267575614875344e-10
5.881801772553929553e-03 3.897710370973417326e-03 3.204878564744273461e-04 5.841594560187286398e-04 3.871670627169377646e-04 3.196496304055179233e-05
3.398709365333374421e-03 1.290573857337662389e-06 6.080824732634937391e-11 5.816766895697378370e-04 2.214931753646655076e-07 nan
2.833242641278266305e-03 6.483481301933213814e-04 1.840922852669457654e-05 4.782120816979825210e-04 1.096022937988530154e-04 3.114561397903811945e-06
2.323418660277853931e-03 7.627067599269565790e-05 3.106637296301784090e-07 4.736144022375358910e-04 1.557553534544121437e-05 6.345446690813183251e-08
9.167550244293387607e-04 8.232761389859177825e-05 9.173616726254607556e-07 2.897524306040218404e-04 2.603773422200433978e-05 2.901720262000714065e-07
7.813867267272289752e-04 1.855858095400897412e-05 5.469231978416644324e-08 2.761335836192751613e-04 6.562456542892905252e-06 1.934001543381863224e-08
3.399070244421542597e-03 9.297240244343640825e-07 3.155342653826664900e-11 5.817382419045000587e-04 1.595627743519635357e-07 0.000000000000000000e+00
3.768213621503035959e-02 1.884808969526985400e-02 1.169774089700759134e-03 1.545298161647055838e-03 7.795898777871262085e-04 4.938279700423598741e-05
1.251206117350633917e-03 4.856003556286125900e-05 2.338470881380061428e-07 3.467665664028579718e-04 1.347124261323159847e-05 6.488000412049132074e-08
2.537662234411097728e-03 5.476718284127546355e-04 1.466593717713848832e-05 4.551803239859413897e-04 9.837648705987583767e-05 2.636209177638863588e-06
1.717555068462051082e-03 6.517572612512179120e-04 3.068767028735486235e-05 3.503255279610663765e-04 1.330213683199608335e-04 6.267893708449075053e-06
1.208516925631604177e-01 4.725381669517414451e-03 2.292576732254580918e-05 3.158302453744184571e-03 1.362743767730573911e-04 6.681030794036549861e-07
5.715063962546951259e-03 8.477998578393375340e-05 1.560516691423430302e-07 7.478557945935619157e-04 1.114509543806079070e-05 2.052115192479520477e-08
1.768500919117954595e-02 5.131433492111536765e-04 1.847459608850243740e-06 1.297095773797380183e-03 3.816589540194480055e-05 1.376028119092817103e-07
2.476861169951272146e-03 2.311207049476848852e-05 2.675955501629800892e-08 4.946353292305474434e-04 4.624792532078969493e-06 5.351307305768692832e-09
5.296782089444507235e-03 3.217668020472075341e-06 2.425348810675131972e-10 7.252390930988942891e-04 4.424828771282465946e-07 nan
4.697146381205996590e-03 2.853403715530333784e-06 2.150777334009035258e-10 6.832039109733871766e-04 4.166310988708612596e-07 2.016372521837331812e-10
5.777722034441090670e-02 2.277854129917322723e-05 1.114289105430543714e-09 2.317877640036788631e-03 9.591491570265053237e-07 nan
2.394713421496996730e-03 3.971154353248351754e-04 8.171143177637674171e-06 4.519761705570505628e-04 7.506316185487886083e-05 1.545336175352130960e-06
7.780414838587379478e-04 1.196744789571102530e-04 2.284037185829035366e-06 2.592378231070670410e-04 3.989444201868592998e-05 7.615259581682127684e-07
1.810363236597334335e-03 4.314054695631508451e-03 1.275582067772340622e-03 2.106862744393539412e-04 5.001316274125536731e-04 1.483856364221385505e-04
4.704872365173251580e-03 5.860692077022111590e-04 9.058427123731505048e-06 6.445780459294262041e-04 8.054738637307352271e-05 1.246009531929264776e-06
2.743997369931627794e-02 1.028197729093105472e-02 4.780490097540113226e-04 1.386565369671359255e-03 5.249844826089362535e-04 2.469442844518871471e-05
2.090416743255607557e-03 2.296532278249996395e-03 3.130509784941004625e-04 3.048489435028723803e-04 3.345527655329782134e-04 4.570586059577909165e-05
2.392321922879858676e-03 7.675021898911893459e-06 3.055220076930709183e-09 4.876262075327797625e-04 1.567453876315545185e-06 6.049117565511995954e-10
4.331549765193232204e-03 2.226451056928757666e-03 1.419991778783824543e-04 5.282946809411097127e-04 2.717906323154824699e-04 1.737634231348079839e-05
3.174030847841846636e-03 4.191026968043409795e-04 6.866455354526124211e-06 5.280796998304266654e-04 6.987526374040358508e-05 1.145494959161382552e-06
1.690557605007914077e-03 7.490912116473680271e-03 4.118530278519161314e-03 1.471135452916152325e-04 6.465301498606995656e-04 3.569124001341867172e-04
1.297422359123645563e-02 1.879368612479352940e-01 3.377889151608299834e-01 2.092217337555750390e-04 2.368905771067088793e-03 3.596117705907292492e-03
6.908199884811061509e-03 6.092406585344578573e-02 6.666773426174454897e-02 1.969083210041262539e-04 1.607199534652646285e-03 1.760678917332616665e-03
4.696095258046373289e-03 3.904339180405003162e-06 4.027747024792915909e-10 6.830517462861677947e-04 5.700796738022687499e-07 nan
1.411178827553705162e-03 8.813812883623484140e-05 6.830436116711524619e-07 3.640670188268700039e-04 2.276250372546960695e-05 1.764312129999052168e-07
1.009037000042622978e-02 9.628859467536443617e-06 1.140106675734386954e-09 9.978968825038363535e-04 9.601775403706300484e-07 nan
2.652215692120263313e-03 8.165882147439518235e-04 3.119609313584348342e-05 4.477385079905983590e-04 1.380198101321337620e-04 5.277836979239734984e-06
3.028475233730842930e-03 1.120119509836037253e-03 5.140525643243520904e-05 4.666657457352155008e-04 1.728007456840163238e-04 7.940438554032870085e-06
2.429118081936754159e-02 7.566461302570504088e-02 2.924420615492850928e-02 6.937344109095920468e-04 2.001738685039045756e-03 8.177086688668543709e-04
1.456658420891487893e-03 7.346281211072280826e-03 4.597060368037197975e-03 1.263198911972761133e-04 6.317829005762263346e-04 3.967129643937621877e-04
2.507375066407302455e-03 2.078779336659009047e-03 2.138455969349362107e-04 3.616890971478745965e-04 2.997318718921877009e-04 3.089868218422932745e-05
4.298826731315097405e-03 1.173228954876037733e-06 3.972999707002600189e-11 6.538612923930423341e-04 1.790809369480234349e-07 0.000000000000000000e+00
6.226892161230290768e-03 4.132767494112510320e-03 3.403403446573527447e-04 6.007784511442849614e-04 3.987974895219349204e-04 3.298413873467023765e-05
1.910308423007434087e-03 3.632590248899836283e-03 8.571013280949113522e-04 2.389377704441381133e-04 4.530482991787293198e-04 1.072279006826373950e-04
5.036142466337878432e-03 6.375738024844146423e-05 1.001534142286431006e-07 7.030710750452764078e-04 8.937039593496439333e-06 1.404047933698051640e-08
4.669430640326099891e-03 1.301194520479942440e-04 4.499076275976676698e-07 6.721061889918007303e-04 1.879806623402857527e-05 6.502137040213351318e-08
1.397547987481484455e-03 1.989382477765033741e-04 3.513764742724134749e-06 3.491200685678052607e-04 4.974178516206780552e-05 8.788112839174723274e-07
4.942206863300713238e-03 5.770952310535371055e-05 8.361359249420274864e-08 6.968606824100341806e-04 8.169661971907512063e-06 1.184064581978245733e-08
1.356957863787533469e-03 1.412185759224193760e-04 1.823560289437864412e-06 3.500976800682358892e-04 3.646909518144775150e-05 4.710278723755814099e-07
1.947830061343025498e-02 1.996312535423649948e-03 2.538685114639172014e-05 1.313767766536603045e-03 1.365048012428527119e-04 1.741183035532518737e-06
2.610653438740895282e-03 8.897033933297215924e-05 3.762219280556422518e-07 5.016456447540025738e-04 1.713076918147712462e-05 7.245560944048473545e-08
1.117916327848300639e-02 1.272389598551737500e-02 1.796940736000562922e-03 6.966407863769742779e-04 7.879631474087792249e-04 1.126523033167798466e-04
2.593162966951534365e-02 1.977861229872790449e-01 1.871822473432045442e-01 4.565569062801400155e-04 2.727165302946223807e-03 2.682492177998480835e-03
3.712477883143439072e-03 4.798271184078828355e-04 7.694998449769840931e-06 5.716730203159087588e-04 7.407029219359866296e-05 1.188678588898081704e-06
6.028127811516181822e-03 3.690684708568259254e-04 2.803717627175572602e-06 7.508795363290569902e-04 4.618002277936961272e-05 3.510588912826447521e-07
1.251282880564197342e-03 4.848401821688774760e-05 2.331012169953794455e-07 3.467878143488223558e-04 1.345015534624173135e-05 6.467298109282662860e-08
3.033394665026278858e-03 9.311400140168402118e-04 3.546532095688448294e-05 4.789264429224827772e-04 1.472157569886175068e-04 5.613314714571653976e-06
8.936822027745261465e-04 1.047930949173991877e-04 1.524702308186576261e-06 2.824664870412985020e-04 3.314214200322742991e-05 4.822804798760321180e-07
1.364882564212122062e-02 1.077010232756199226e-01 1.054501510822591914e-01 3.076629038095720476e-04 2.124102510508658458e-03 2.111750258013533627e-03
5.787503273568139761e-03 6.046582518983711907e-04 7.838474533006234424e-06 7.210813747209086433e-04 7.564061442676010881e-05 9.814655984536113222e-07
3.833988033839097476e-02 3.220378078565655500e-02 3.356338875952769030e-03 1.397513429200876196e-03 1.165157520810303953e-03 1.254575826749051396e-04
2.715761361468338464e-03 2.252436985899164412e-03 2.318016526341448724e-04 3.763612978417964976e-04 3.120024463520966939e-04 3.218202531346794014e-05
3.006229598809140313e-03 1.922449767928213760e-04 1.525424398352015487e-06 5.305066195739642151e-04 3.400128797353904619e-05 2.698882294552621283e-07
1.891358154537892133e-03 7.152482132205539855e-03 3.356159713256090527e-03 1.703613131098664349e-04 6.394245634979795964e-04 3.013730463514092722e-04
2.105144515130996652e-03 4.812069896467097152e-04 1.364849522134115034e-05 4.124086931280548018e-04 9.437982448455338274e-05 2.678501228831333262e-06
3.835137993501325226e-03 2.977945613841459505e-03 2.869163926568774059e-04 4.546815480235689272e-04 3.529040740682853265e-04 3.410510376519215091e-05
3.375038055731582887e-03 2.493907854383969891e-05 2.286572553522603357e-08 5.776391607491983661e-04 4.280037136994105531e-06 3.922004375588851318e-09
7.780938977313134330e-04 1.196241398904174247e-04 2.281962378614110776e-06 2.592552734324883590e-04 3.987766309731454958e-05 7.608341593795039169e-07
2.775636599335218335e-03 1.608678019193954256e-03 1.156853814687774928e-04 4.133564260776421669e-04 2.396538759558311082e-04 1.726396319110759541e-05
3.194330902976272313e-03 5.667849182433570832e-06 1.247842718044012145e-09 5.635942738231342498e-04 1.002627423881879242e-06 2.328306436538696289e-10
1.747469196154249893e-02 2.530349219753702528e-05 4.546260257143330819e-09 1.306962823194332849e-03 1.919903127292104441e-06 3.681375715146283064e-10
6.989891577062756767e-04 1.943086531963622576e-04 6.702189096374766564e-06 2.329165828935913086e-04 6.476950539923750493e-05 2.234581980164695417e-06
6.614030707184559432e-02 1.093535515179344664e-02 2.243377763628817689e-04 2.292852707655675115e-03 3.955502219385008270e-04 8.231074531895608484e-06
2.411978139533088594e-03 3.561945727703252906e-02 6.526856458343521794e-02 7.788170749668348037e-05 1.093299249701604279e-03 1.952394768267097167e-03
6.594518268384641502e-03 5.481166332144127296e-06 5.652829315749841044e-10 8.084920396515106553e-04 6.756384831017485455e-07 2.016372521837331812e-10
1.356892091809669409e-03 1.412826054216775873e-04 1.825302767155534411e-06 3.500807338353446592e-04 3.648562818963924369e-05 4.714780147761798914e-07
9.840546275110551022e-04 1.142981140018761721e-04 1.647258487391667359e-06 2.965409116609592113e-04 3.446639348438792046e-05 4.968113573652845059e-07
5.927285660862979810e-03 5.532063633517658729e-03 6.406507056202492834e-04 5.382328632008562047e-04 5.014395883273027902e-04 5.839062452253743928e-05
2.194954811566063313e-03 2.137562089633182616e-02 2.582942429210333124e-02 1.004569269077717841e-04 9.513408640460894062e-04 1.147255147521519759e-03
1.373086803498679842e-03 5.949290217208691445e-04 3.198417478111892365e-05 3.068531751119815535e-04 1.330082617201196410e-04 7.155447996806420434e-06
2.023528244608623350e-01 4.717417454802586008e-05 1.364590218599914806e-09 3.909909762682372593e-03 1.093227843188698255e-06 1.164153218269348145e-10
3.470213160337243252e-03 7.116770818880180371e-04 1.810975777583045954e-05 5.344973979446803435e-04 1.098352188618689302e-04 2.797460927144586127e-06
2.590468295203374183e-03 5.927049025531427873e-04 1.682680224357469001e-05 4.573282816989536698e-04 1.047864367524951819e-04 2.977063336483037726e-06
6.609784067521662365e-03 8.145083922090901041e-02 1.245393767115698935e-01 1.540774580590637650e-04 1.702237486397885184e-03 2.510399097958405240e-03
9.562050410389932864e-04 2.639642054379942593e-03 9.041529045799023834e-04 1.426603938264956047e-04 3.928362789064520559e-04 1.348223651638137286e-04
4.492867610641271270e-03 3.236978205827090171e-02 2.893735033108790766e-02 1.788890341555167136e-04 1.238706366898533915e-03 1.115089667098118596e-03
3.600313303065982851e-03 4.804238837707419663e-03 7.954478592255842528e-04 3.753752453258422722e-04 4.994594522796353504e-04 8.306771805158892803e-05
1.104662833563563318e-02 1.257670217622708364e-02 1.776669488137816444e-03 6.924445485490464229e-04 7.834994494957730690e-04 1.120307198878705299e-04
4.599423023753601569e-03 5.769672664079905644e-07 8.981260180007666349e-12 6.762620168982608508e-04 8.515301350724944157e-08 nan
3.805880605665779015e-03 8.694726519362649952e-04 2.464674239721631466e-05 5.540645187953290160e-04 1.268435742055592586e-04 3.599493002316104898e-06
3.350060599536019978e-03 4.426811454967261028e-04 7.258254968833810494e-06 5.424481771521767791e-04 7.183927162265881449e-05 1.178623565214345992e-06
3.399010867212837184e-03 9.890970733561488260e-07 3.571365425614203559e-11 5.817281143996687722e-04 1.697524217286406530e-07 1.646361269956798229e-10
7.700198372708744188e-04 2.983671197265280739e-05 1.434507566067111384e-07 2.721197443048924873e-04 1.055037121064030629e-05 5.072823529745880182e-08

</pre></div></div>
</div>
<p>There are 100 rows corresponding to 100 clustered states. 6 columns corresponding to populations of each state (row) for 3 lambda values (first 3 columns) and population change (last 3 columns).</p>
<p>Then let’s take a look at the output figure (“BICePs.pdf”).</p>
<p>The top left panel shows the population of each states in the presence (y-axis) and absense (x-axis) of computational modeling prior information. You can find some states (e.g state 38, 59) get awarded after including computational prior information. If you check <a class="reference external" href="https://onlinelibrary.wiley.com/doi/full/10.1002/jcc.23738">this work</a> you will see how misleading the results will be if we only use experimental restraints without computational prior information. The other three panels show the
distribution of nuisance parameters in the presence or absence of computational modeling information. It may not be clear in this example due to the limit of finite sampling, but based on our experience, including prior information from our simulations will lower the nuisance parameters than only using experimental restraints.</p>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Temple University

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"processClass": "math|output_area", "processEscapes": true, "ignoreClass": "document", "inlineMath": [["$", "$"], ["\\(", "\\)"]]}})</script>
    

  

  <script type="text/javascript" src="../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>