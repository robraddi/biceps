

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Theory &mdash; BICePs 2.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Workflow" href="workflow.html" />
    <link rel="prev" title="Installation" href="installation.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> BICePs
          

          
          </a>

          
            
            
              <div class="version">
                2.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Theory</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#bayesian-inference">Bayesian inference</a></li>
<li class="toctree-l2"><a class="reference internal" href="#reference-potentials">Reference potentials</a></li>
<li class="toctree-l2"><a class="reference internal" href="#biceps-scores-for-quantitative-model-selection">BICePs scores for quantitative model selection</a></li>
<li class="toctree-l2"><a class="reference internal" href="#summary-of-the-key-advantages-of-biceps">Summary of the key advantages of BICePs.</a></li>
<li class="toctree-l2"><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="workflow.html">Workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/index.html">Tutorials &amp; Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="biceps.html">API Reference</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">BICePs</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Theory</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/theory.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="theory">
<span id="id1"></span><h1>Theory<a class="headerlink" href="#theory" title="Permalink to this headline">¶</a></h1>
<div class="section" id="bayesian-inference">
<h2>Bayesian inference<a class="headerlink" href="#bayesian-inference" title="Permalink to this headline">¶</a></h2>
<p>Bayesian inference approaches for modeling conformational ensembles
generally seek to model a <em>posterior</em> distribution <span class="math notranslate nohighlight">\(P(X|D)\)</span> of
conformational states <span class="math notranslate nohighlight">\(X\)</span>, given some experimental data <span class="math notranslate nohighlight">\(D\)</span>.
According to Bayes’ theorem, the posterior distribution is proportional
to a product of (1) a <em>likelihood</em> function <span class="math notranslate nohighlight">\(Q(D|X)\)</span> of observing
the experimental data given a conformational state <span class="math notranslate nohighlight">\(X\)</span>, and (2) a
<em>prior</em> distribution <span class="math notranslate nohighlight">\(P(X)\)</span> representing any prior knowledge about
conformational states.</p>
<div class="math notranslate nohighlight">
\[P(X|D) \propto Q(D|X) P(X)\]</div>
<p>Here, the prior <span class="math notranslate nohighlight">\(P(X)\)</span> comes from theoretical modeling, while the
likelihood <span class="math notranslate nohighlight">\(Q(D|X)\)</span> corresponds to experimental restraints,
typically in the form of some error model reflecting how well a given
conformation <span class="math notranslate nohighlight">\(X\)</span> agrees with experimental measurements. One can
think of <span class="math notranslate nohighlight">\(Q(D|X)\)</span> as a reweighting factor for the population of
each state <span class="math notranslate nohighlight">\(X\)</span>, and the BICePs algorithm can be thought of as a
way to reweight conformational populations to agree with experimental
knowledge.</p>
<p>In BICePs, the error model reflects both uncertainty in the experimental
measurements and heterogeneity in the conformational ensemble, (i.e. how
likely are the observables for conformation <span class="math notranslate nohighlight">\(X\)</span> to be away from
the ensemble-average measurement, either due to experimental noise or
conformational heterogeneity). These uncertainties are usually not known
<em>a priori</em>, and must be treated as nuisance parameters <span class="math notranslate nohighlight">\(\sigma\)</span>
which can be modeled using some prior model <span class="math notranslate nohighlight">\(P(\sigma)\)</span>:</p>
<div class="math notranslate nohighlight">
\[P(X,\sigma | D) \propto Q(D|X,\sigma) P(X) P(\sigma)\]</div>
<p>Posterior sampling over <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(\sigma\)</span> using Markov Chain
Monte Carlo (MCMC) can then be used to determine the conformational
populations given the experimental restraints as
<span class="math notranslate nohighlight">\(P(X|D) = \int P(X,\sigma | D) d\sigma\)</span>. Similarly, the posterior
distribution of the experimental uncertainty
<span class="math notranslate nohighlight">\(P(\sigma | D) = \int P(X,\sigma | D) dX\)</span> gives information about
how well the posterior conformational distribution agrees with the
experimental restraints.</p>
</div>
<div class="section" id="reference-potentials">
<h2>Reference potentials<a class="headerlink" href="#reference-potentials" title="Permalink to this headline">¶</a></h2>
<p>The correct implementation of reference potentials is an importance
advantage of the BICePs algorithm. The experimental data used to
construct the likelihood function comes from some set of
ensemble-averaged experimental observables
<span class="math notranslate nohighlight">\(\mathbf{r} = (r_1, r_2, ..., r_N)\)</span>. Such observables are
low-dimensional projections of some high-dimensional state space
<span class="math notranslate nohighlight">\(X\)</span>, and therefore these restraints in the space of observables
need to be treated as <em>potentials of mean force</em>. <a class="footnote-reference brackets" href="#f1" id="id2">1</a> <a class="footnote-reference brackets" href="#f2" id="id3">2</a> <a class="footnote-reference brackets" href="#f3" id="id4">3</a></p>
<div class="math notranslate nohighlight">
\[P(X | D) \propto \bigg[ \frac{Q(\mathbf{r}(X)|D)}{Q_{\text{ref}}(\mathbf{r}(X))} \bigg] P(X)\]</div>
<p>The bracketed weighting function is now a ratio, with the numerator
<span class="math notranslate nohighlight">\(Q(\mathbf{r}|D)\)</span> being a likelihood function enforcing
experimental restraints in the space of observables, while the
denominator <span class="math notranslate nohighlight">\(Q_{\text{ref}}(\mathbf{r})\)</span> reflects some reference
distribution for possible values of the observables <span class="math notranslate nohighlight">\(\mathbf{r}\)</span>
in the absence of any experimental restraint information, such that
<span class="math notranslate nohighlight">\(-\ln [Q(\mathbf{r}|D)/Q_{\text{ref}}(\mathbf{r})]\)</span> is a potential
of mean force. Without reference potentials, a great deal of unnecessary
bias is introduced when many non-informative restraints are used.</p>
<p>As an example to illustrate the importance of reference potentials,
consider an experimental distance restraint applied to two residues of a
polypeptide chain (Figure 1). In the absence of any
experimental information, we assume a reference potential
<span class="math notranslate nohighlight">\(Q_{\text{ref}}(\mathbf{r})\)</span> corresponding to the end-to-end
distance of a random-coil polymer with a chain length equal to that of
the intervening residues. For residues near each other along the chain,
a short-distance restraint may have
<span class="math notranslate nohighlight">\([Q(\mathbf{r}|D)/Q_{\text{ref}}(\mathbf{r})] \sim 1\)</span>,
contributing little or no information to refine the conformational
ensemble. If the residues are far apart along the chain, however, a
short-distance restraint can be highly informative, with
<span class="math notranslate nohighlight">\([Q(\mathbf{r}|D)/Q_{\text{ref}}(\mathbf{r})]\)</span> greatly rewarding
small distances where the reference potential
<span class="math notranslate nohighlight">\(Q_{\text{ref}}(\mathbf{r})\)</span> is small.</p>
<div class="figure align-center" id="id7">
<img alt="_images/Figure1.pdf" src="_images/Figure1.pdf" />
<p class="caption"><span class="caption-text">Figure 1.</span><a class="headerlink" href="#id7" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="biceps-scores-for-quantitative-model-selection">
<h2>BICePs scores for quantitative model selection<a class="headerlink" href="#biceps-scores-for-quantitative-model-selection" title="Permalink to this headline">¶</a></h2>
<p>Another key advantage of the BICePs algorithm is its the ability to use
the sampled posterior probability function to perform quantitative model
selection. This is done through a quantity we will call the <em>BICePs
score</em>.</p>
<p>Consider <span class="math notranslate nohighlight">\(K\)</span> different theoretical models <span class="math notranslate nohighlight">\(P^{(k)}(X)\)</span>,
<span class="math notranslate nohighlight">\(k=1,...,K\)</span>, that we may wish to use as our prior distribution.
Perhaps these models come from simulations using different potential
energy functions. Or perhaps we want to compare a model shaped only
experimental restraints, to a model using both simulation and
experimental information. Which model is more consistent with the
experimental data? To determine this, we compute the posterior
likelihood of the model, <span class="math notranslate nohighlight">\(Z^{(k)}\)</span>, by integrating the
<span class="math notranslate nohighlight">\(k^{th}\)</span> posterior distribution across all conformations <span class="math notranslate nohighlight">\(X\)</span>
and values of <span class="math notranslate nohighlight">\(\sigma\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}Z^{(k)} = \int P^{(k)}(X,\sigma | D)  dX d\sigma  &amp;=&amp; \int P^{(k)}(X) Q(X) dX\\
 \text{total evidence for model } P^{(k)} &amp;&amp; \text{overlap integral}\end{split}\]</div>
<p>The quantity <span class="math notranslate nohighlight">\(Z^{(k)}\)</span> can be interpreted as the total evidence in
favor of a given model. Equivalently, we can think of this term as an
overlap integral between the prior <span class="math notranslate nohighlight">\(P^{(k)}(X)\)</span> and a likelihood
function
<span class="math notranslate nohighlight">\(Q(X) = \int [Q(\mathbf{r}(X)|D,\sigma)/Q_{\text{ref}}(\mathbf{r}(X)) ] P(\sigma) d\sigma\)</span>.
The overlap integral quantifies how well the theoretical modeling agrees
with the experimental data (Figure 2); i.e. the
value of <span class="math notranslate nohighlight">\(Z^{(k)}\)</span> is maximal when <span class="math notranslate nohighlight">\(P^{(k)}(X)\)</span> most closely
matches the likelihood distribution <span class="math notranslate nohighlight">\(Q(X)\)</span> specified by the
experimental restraints.</p>
<div class="figure align-center" id="id8">
<img alt="_images/Figure2.pdf" src="_images/Figure2.pdf" />
<p class="caption"><span class="caption-text">Figure 2.</span><a class="headerlink" href="#id8" title="Permalink to this image">¶</a></p>
</div>
<p>In Bayesian statistics, the so-called Bayes factor,
<span class="math notranslate nohighlight">\(Z^{(1)}/Z^{(2)}\)</span> is a likelihood ratio that can be used to choose
between competing models (1) and (2), similar to a likelihood-ratio test
in classical statistics. In order to assign each model a unique score,
we define a free energy-like quantity,</p>
<div class="math notranslate nohighlight">
\[f^{(k)} = -\ln \frac{Z^{(k)}}{Z_0}\]</div>
<p>to compare model <span class="math notranslate nohighlight">\(P^{(k)}(X,\sigma|D)\)</span> against some reference
model <span class="math notranslate nohighlight">\(Z_0\)</span>. In practice, we choose the reference model to be the
posterior for a uniform prior <span class="math notranslate nohighlight">\(P(X)\)</span>, i.e. no information from
theoretical modeling. We call <span class="math notranslate nohighlight">\(f^{(k)}\)</span> the BICePs score. The
BICePs score provides an unequivocal measure of model quality, to be
used for objective model selection. The lower the BICePs score, the
better the model (Figure 2). This useful property means that the
BICePs score can be used a metric for force field validation and
parameterization. In addition, the BICePs score has a useful physical
interpretation: it reflects the improvement (or disimprovement) of the
posterior distribution when going from a conformation ensemble shaped
only experimental constraints, to a new distribution additionally shaped
by a theoretical model.</p>
</div>
<div class="section" id="summary-of-the-key-advantages-of-biceps">
<h2>Summary of the key advantages of BICePs.<a class="headerlink" href="#summary-of-the-key-advantages-of-biceps" title="Permalink to this headline">¶</a></h2>
<p>To put the BICePs algorithm in a larger context, we summarize the its
key advantages as follows:</p>
<ul class="simple">
<li><p>BICePs can be used with molecular dynamics (MD) or quantum mechanics
(QM) methods. Conformational states can be individual conformations
(like single-point QM minima) or collections of conformations (e.g.
from clustering of trajectory data), as long as experimental
observables can be attached to each conformational state.</p></li>
<li><p>BICePs performs reweighting of conformational states derived from
modeling; it is currently a post-processing algorithm (MCMC) with no
additional MD or QM required.</p></li>
<li><p>Bayesian inference offers a rigorous statistical framework for
achieving the correct balance of theoretical modeling and
experimental data.</p></li>
<li><p>BICePs correctly uses reference potentials, which is essential to
proper weighing of experimental restraints</p></li>
<li><p>With proper reference potentials, BICePs scores can be used for
unambiguous, objective model selection.</p></li>
</ul>
<p>For more details about theory beneath BICePs, please check these work. <a class="footnote-reference brackets" href="#f4" id="id5">4</a> <a class="footnote-reference brackets" href="#f5" id="id6">5</a></p>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<dl class="footnote brackets">
<dt class="label" id="f1"><span class="brackets"><a class="fn-backref" href="#id2">1</a></span></dt>
<dd><p>Olsson, S.; Frellsen, J.; Boomsma, W.; Mardia, K. V.; Hamelryck, T. <a class="reference external" href="http://journals.plos.org/plosone/article?id=10.1371/journal.pone.0079439">Inference of Structure Ensembles of Flexible Biomolecules from Sparse, Averaged Data.</a> PLoS One 2013, 8, e79439</p>
</dd>
<dt class="label" id="f2"><span class="brackets"><a class="fn-backref" href="#id3">2</a></span></dt>
<dd><p>Olsson, S.; Boomsma, W.; Frellsen, J.; Bottaro, S.; Harder, T.; Ferkinghoff-Borg, J.; Hamelryck, T. <a class="reference external" href="https://www.sciencedirect.com/science/article/pii/S1090780711003090?via%3Dihub">Generative Probabilistic Models Extend the Scope of Inferential Structure Determination.</a> J. Magn. Reson. 2011, 213, 182−186.</p>
</dd>
<dt class="label" id="f3"><span class="brackets"><a class="fn-backref" href="#id4">3</a></span></dt>
<dd><p>Hamelryck, T.; Borg, M.; Paluszewski, M.; Paulsen, J.; Frellsen, J.; Andreetta, C.; Boomsma, W.; Bottaro, S.; Ferkinghoff-Borg, J. <a class="reference external" href="http://journals.plos.org/plosone/article?id=10.1371/journal.pone.0013714">Potentials of Mean Force for Protein Structure Prediction Vindicated, Formalized and Generalized.</a> PLoS One 2010, 5, e13714.</p>
</dd>
<dt class="label" id="f4"><span class="brackets"><a class="fn-backref" href="#id5">4</a></span></dt>
<dd><p>Voelz, V. A.; Zhou, G. <a class="reference external" href="https://onlinelibrary.wiley.com/doi/abs/10.1002/jcc.23738">Bayesian Inference of Conformational State Populations from Computational Models and Sparse Exper- imental Observables.</a> J. Comput. Chem. 2014, 35, 2215−2224.</p>
</dd>
<dt class="label" id="f5"><span class="brackets"><a class="fn-backref" href="#id6">5</a></span></dt>
<dd><p>Yunhui Ge and Vincent A. Voelz, <a class="reference external" href="https://pubs.acs.org/doi/10.1021/acs.jpcb.7b11871">Model selection using BICePs: A Bayesian approach to force field validation and parameterization</a> Journal of Physical Chemistry B (2018) 122 (21): 5610–5622</p>
</dd>
</dl>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="workflow.html" class="btn btn-neutral float-right" title="Workflow" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="installation.html" class="btn btn-neutral float-left" title="Installation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Temple University, Yunhui Ge, Robert M. Raddi, Vincent A. Voelz


    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>